<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OpenClaw Control Board</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¦</text></svg>">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <!-- Tabler Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@latest/tabler-icons.min.css">
  <link rel="stylesheet" href="src/style.css?v=7">
  <!-- CodeMirror for code editing -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.65.15/lib/codemirror.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.65.15/theme/material-darker.css">
</head>
<body>
  <div id="app">
    <header id="top-bar" class="top-bar">
      <div class="top-left">
        <div class="logo">
          <span class="logo-icon">ğŸ¦</span>
          <h1 class="logo-text">OpenClaw</h1>
        </div>
      </div>
      <nav class="top-nav">
        <button class="nav-btn active" data-view="kanban">Kanban</button>
        <button class="nav-btn" data-view="agents">Agents</button>
        <button class="nav-btn" data-view="calendar">Calendar</button>
        <button class="nav-btn" data-view="activity">Activity</button>
        <button class="nav-btn" data-view="security">Security</button>
      </nav>
      <div class="top-right">
        <div class="stats-row">
          <span class="stat" title="Working agents (active in last 30s)">ğŸŸ¢ <span id="stat-working">0</span></span>
          <span class="stat" title="Idle agents">ğŸ”˜ <span id="stat-idle">0</span></span>
          <span class="stat" title="RAM usage">ğŸ’¾ <span id="stat-ram">--</span>%</span>
          <span class="stat" title="Disk usage">ğŸ’¿ <span id="stat-disk">--</span>%</span>
        </div>
        <button id="btn-settings" class="btn btn-icon" title="Settings">âš™ï¸</button>
      </div>
    </header>

    <main id="content">
      <!-- Kanban View -->
      <div id="view-kanban" class="view active">
        <div class="view-header">
          <h2>Task Board</h2>
          <div class="editor-actions">
            <button id="btn-add-task" class="btn btn-primary">+ New Task</button>
          </div>
        </div>
        <div class="kanban-wrapper">
          <div id="kanban-board" class="kanban-board"></div>
        </div>
      </div>

      <!-- Agents View -->
      <div id="view-agents" class="view">
        <div class="view-header">
          <h2>Agent Sessions</h2>
          <button id="btn-refresh-agents" class="btn btn-secondary">ğŸ”„ Refresh</button>
        </div>
        <div id="agent-list" class="agent-grid"></div>
      </div>

      <!-- Subagents View -->
      <div id="view-subagents" class="view">
        <div class="view-header">
          <h2>ğŸ¤– Subagents</h2>
          <button id="btn-refresh-subagents" class="btn btn-secondary">ğŸ”„ Refresh</button>
        </div>
        <div id="subagent-list" class="agent-grid"></div>
      </div>

      <!-- Calendar View -->
      <div id="view-calendar" class="view">
        <div class="view-header">
          <h2>ğŸ“… Scheduled Jobs</h2>
          <div class="editor-actions">
            <select id="cal-filter-agent" class="filter-select">
              <option value="">All Agents</option>
            </select>
            <div class="cal-view-toggle">
              <button id="btn-cal-week" class="btn btn-primary cal-toggle-btn active" title="Week view">ğŸ“… Week</button>
              <button id="btn-cal-timeline" class="btn btn-secondary cal-toggle-btn" title="Timeline view">ğŸ• Timeline</button>
            </div>
            <button id="btn-cal-prev" class="btn btn-secondary">â† Prev</button>
            <span id="cal-week-label" class="pagination-info"></span>
            <button id="btn-cal-next" class="btn btn-secondary">Next â†’</button>
            <button id="btn-cal-today" class="btn btn-primary">Today</button>
          </div>
        </div>
        <div id="calendar-grid" class="calendar-grid"></div>
        <div id="cal-job-list" class="cal-job-list"></div>
      </div>

      <!-- Activity View -->
      <div id="view-activity" class="view">
        <div class="view-header">
          <h2>ğŸ“Š Activity Feed</h2>
          <div class="editor-actions">
            <select id="activity-agent-filter" class="filter-select">
              <option value="">All Agents</option>
            </select>
            <select id="activity-action-filter" class="filter-select">
              <option value="">All Actions</option>
              <option value="file_write">File Write</option>
              <option value="task_create">Task Create</option>
              <option value="task_move">Task Move</option>
              <option value="agent_run_start">Agent Run</option>
              <option value="tool_start">Tool Call</option>
              <option value="message">Message</option>
              <option value="search">Search</option>
            </select>
            <button id="btn-refresh-activity" class="btn btn-secondary">ğŸ”„ Refresh</button>
          </div>
        </div>
        <div id="activity-timeline" class="activity-timeline">
          <div class="loading">Loading activity...</div>
        </div>
      </div>

      <!-- Security View -->
      <div id="view-security" class="view">
        <div class="view-header">
          <h2>ğŸ›¡ï¸ Security Panel</h2>
          <button id="btn-refresh-security" class="btn btn-secondary">ğŸ”„ Refresh</button>
        </div>
        <div id="security-threats" class="security-threats"></div>
        <div class="security-grid">
          <div class="security-section">
            <h3 class="security-section-title">ğŸŒ Tailscale</h3>
            <div id="security-tailscale" class="security-card-body"><div class="loading">Loading...</div></div>
          </div>
          <div class="security-section">
            <h3 class="security-section-title">ğŸ”‘ SSH Activity</h3>
            <div id="security-ssh" class="security-card-body"><div class="loading">Loading...</div></div>
          </div>
        </div>
        <div class="security-section" style="margin-top:14px;">
          <h3 class="security-section-title">ğŸ“‹ OpenClaw Auth Events</h3>
          <div id="security-auth" class="security-card-body"><div class="loading">Loading...</div></div>
        </div>
      </div>

      <!-- File Editor -->
      <div id="view-editor" class="view">
        <div class="view-header">
          <h2 id="editor-title">Editor</h2>
          <div class="editor-actions">
            <button id="btn-toggle-preview" class="btn btn-secondary" style="display:none;">ğŸ‘ï¸ Preview</button>
            <button id="btn-save" class="btn btn-primary">ğŸ’¾ Save</button>
            <button id="btn-close-editor" class="btn btn-secondary">âœ• Close</button>
          </div>
        </div>
        <div id="editor-container">
          <textarea id="editor" spellcheck="false"></textarea>
        </div>
        <div id="markdown-preview" class="markdown-body" style="display:none;"></div>
        <div id="editor-status" class="status-bar"></div>
      </div>

      <!-- JSONL Viewer -->
      <div id="view-jsonl" class="view">
        <div class="view-header">
          <h2 id="jsonl-title">JSONL Viewer</h2>
          <div class="editor-actions">
            <button id="btn-jsonl-prev" class="btn btn-secondary">â† Prev</button>
            <span id="jsonl-pagination" class="pagination-info"></span>
            <button id="btn-jsonl-next" class="btn btn-secondary">Next â†’</button>
            <button id="btn-jsonl-last" class="btn btn-secondary">Last â­</button>
            <button id="btn-jsonl-raw" class="btn btn-secondary">ğŸ“ Raw</button>
            <button id="btn-close-jsonl" class="btn btn-secondary">âœ• Close</button>
          </div>
        </div>
        <div id="jsonl-filters" class="jsonl-filters">
          <input type="text" id="jsonl-search" placeholder="Filter lines..." class="filter-input">
          <select id="jsonl-role-filter" class="filter-select">
            <option value="">All roles</option>
            <option value="user">User</option>
            <option value="assistant">Assistant</option>
            <option value="system">System</option>
            <option value="tool">Tool</option>
          </select>
        </div>
        <div id="jsonl-lines" class="jsonl-lines"></div>
        <div id="jsonl-edit-modal" class="modal hidden">
          <div class="modal-content wide">
            <div class="modal-header">
              <h3 id="jsonl-edit-title">Edit Line</h3>
              <button id="btn-jsonl-edit-close" class="btn btn-ghost">âœ•</button>
            </div>
            <textarea id="jsonl-edit-area" spellcheck="false"></textarea>
            <div class="modal-actions">
              <button id="btn-jsonl-edit-format" class="btn btn-secondary">ğŸ¨ Format</button>
              <button id="btn-jsonl-edit-save" class="btn btn-primary">ğŸ’¾ Save</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Command Palette -->
      <div id="command-palette" class="modal hidden">
        <div class="palette-content">
          <input id="palette-input" class="palette-input" type="text" placeholder="Search commands..." autocomplete="off" spellcheck="false">
          <div id="palette-results" class="palette-results"></div>
        </div>
      </div>

      <!-- Task Modal -->
      <div id="task-modal" class="modal hidden">
        <div class="modal-content">
          <div class="modal-header">
            <h3 id="task-modal-title">New Task</h3>
            <button id="btn-task-close" class="btn btn-ghost">âœ•</button>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <label class="form-label">Title</label>
              <input id="task-title" class="form-input" type="text" placeholder="What needs to be done?">
            </div>
            <div class="form-group">
              <label class="form-label">Description</label>
              <textarea id="task-desc" class="form-textarea" placeholder="Details, notes, links..."></textarea>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">Assign to</label>
                <select id="task-agent" class="form-select">
                  <option value="">Unassigned</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Priority</label>
                <select id="task-priority" class="form-select">
                  <option value="low">Low</option>
                  <option value="normal" selected>Normal</option>
                  <option value="high">High</option>
                  <option value="urgent">Urgent</option>
                </select>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label class="form-label">Status</label>
                <select id="task-status" class="form-select">
                  <option value="backlog">Backlog</option>
                  <option value="in-progress">In Progress</option>
                  <option value="review">Review</option>
                  <option value="done">Done</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">Tags (comma separated)</label>
                <input id="task-tags" class="form-input" type="text" placeholder="coding, ui, bug">
              </div>
            </div>
          </div>
          <div class="modal-actions">
            <button id="btn-task-delete" class="btn btn-secondary" style="color:var(--red); margin-right:auto; display:none;">ğŸ—‘ï¸ Delete</button>
            <button id="btn-task-cancel" class="btn btn-secondary">Cancel</button>
            <button id="btn-task-save" class="btn btn-primary">Save Task</button>
          </div>
        </div>
      </div>

      <!-- Settings Modal -->
      <div id="settings-modal" class="modal hidden">
        <div class="modal-content">
          <div class="modal-header">
            <h3>âš™ï¸ Settings</h3>
            <button id="btn-settings-close" class="btn btn-ghost">âœ•</button>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <label class="form-label">Board Name</label>
              <input id="settings-board-name" class="form-input" type="text" placeholder="Zen HQ, Mission Control, etc.">
              <span style="font-size:12px;color:var(--text-dim);margin-top:4px;display:block;">Make it personal â€” this appears in the header and browser tab</span>
            </div>
            <div class="form-group">
              <label class="form-label">Board Icon (emoji)</label>
              <input id="settings-board-icon" class="form-input" type="text" placeholder="ğŸ¦" maxlength="2">
            </div>
            <div class="form-group">
              <label class="form-label">Theme</label>
              <div class="theme-grid">
                <button class="theme-btn active" data-theme="default" title="Default Dark">
                  <span class="theme-preview" style="--preview-bg: #0a0e14; --preview-card: #12171e; --preview-accent: #f97316;"></span>
                  <span class="theme-name">Default</span>
                </button>
                <button class="theme-btn" data-theme="oled" title="OLED (Pure Black)">
                  <span class="theme-preview" style="--preview-bg: #000000; --preview-card: #0a0a0a; --preview-accent: #f97316;"></span>
                  <span class="theme-name">OLED</span>
                </button>
                <button class="theme-btn" data-theme="light" title="Light">
                  <span class="theme-preview" style="--preview-bg: #f8fafc; --preview-card: #ffffff; --preview-accent: #ea580c;"></span>
                  <span class="theme-name">Light</span>
                </button>
                <button class="theme-btn" data-theme="nord" title="Nord">
                  <span class="theme-preview" style="--preview-bg: #2e3440; --preview-card: #3b4252; --preview-accent: #88c0d0;"></span>
                  <span class="theme-name">Nord</span>
                </button>
                <button class="theme-btn" data-theme="dracula" title="Dracula">
                  <span class="theme-preview" style="--preview-bg: #282a36; --preview-card: #44475a; --preview-accent: #ff79c6;"></span>
                  <span class="theme-name">Dracula</span>
                </button>
                <button class="theme-btn" data-theme="matrix" title="Matrix">
                  <span class="theme-preview" style="--preview-bg: #0d0d0d; --preview-card: #0a0f0a; --preview-accent: #00ff41;"></span>
                  <span class="theme-name">Matrix</span>
                </button>
              </div>
            </div>
            <div class="form-group" id="custom-colors-group" style="display:none;">
              <label class="form-label">Custom Accent Color</label>
              <div class="custom-color-row">
                <input type="color" id="settings-accent-color" value="#f97316">
                <span style="font-size:11px;color:var(--text-dim);margin-left:8px;">Click color picker to customize</span>
              </div>
            </div>
          </div>
          <div class="modal-actions">
            <button id="btn-settings-cancel" class="btn btn-secondary">Cancel</button>
            <button id="btn-settings-save" class="btn btn-primary">ğŸ’¾ Save</button>
          </div>
        </div>
      </div>

    </main>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.15/lib/codemirror.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.15/mode/javascript/javascript.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.15/mode/python/python.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.15/mode/markdown/markdown.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.15/mode/htmlmixed/htmlmixed.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.15/mode/css/css.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.15/addon/edit/closebrackets.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.15/addon/edit/matchbrackets.js"></script>
  <script src="src/app.js?v=6"></script>
</body>
</html>
